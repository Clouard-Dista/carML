<!DOCTYPE html>
<html>
<head>
	<title></title>
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
	<script src="util.js"></script>
	<script src="bound.js"></script>
	<script src="car.js"></script>
</head>
<body>
	<div style="display:none;">
		<canvas id="canvastmp" width="0" height="0"></canvas>
		<img id="map" src="data:image/png;base64,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">
	</div>
	<canvas id="canvas" width="1000" height="600" style="border:1px solid #d3d3d3;"></canvas>
	<script>
		//////////////////////////////////
		var context;
		var contextTmp;
		window.onload = function(){
		    var canvas = document.getElementById("canvas");
		    context = canvas.getContext("2d");
		    context.height=canvas.height;
		    context.width=canvas.width;
		    context.frame = 0;

			var canvastmp = document.getElementById('canvastmp');
			contextTmp = canvastmp.getContext('2d');
			var img = document.getElementById("map");
			img.crossOrigin = "Anonymous";
			canvastmp.width = img.width;
			canvastmp.height = img.height;
			contextTmp.width = img.width;
			contextTmp.height = img.height;
			contextTmp.drawImage(img, 0, 0 );

		    main(context);
		}
		var caraz = new Car("red");
		//toucheHaut=38//toucheBas=40//toucheGauche=37//toucheDroite=39//space=32
		document.initKeys([38,40,37,39,32]);
		var picture = document.getElementById('map');
		canvas.addEventListener('click', function(evt) {
			var mousePos = getMousePos(canvas, evt);
			console.log(getPixelValRGB( mousePos.x,mousePos.y))
		}, false);
		window.requestAnimFrame = (
		    function(){
		        return  function(callback, element){window.setTimeout(callback, 1000 / 60);};
		    }
		)();
		function main(ctx,playeur){

			caraz.vitesse(0.5);
			if(document.getKey(38) == 1){
				caraz.vitesse(1);
			}else if(document.getKey(40) == 1){
				caraz.vitesse(-1);
			}
			if(document.getKey(32) == 1){
				caraz.vitesse(0);
			}
			if(document.getKey(37) == 1){
				caraz.controle(-1);
			}
			if(document.getKey(39) == 1){
				caraz.controle(1);
			}

			ctx.frame++
			ctx.drawImage(picture,0,0);
			
			caraz.move()
			caraz.draw(ctx)
			if(caraz.isOut()){
				caraz = new Car(caraz.color);
			}
		    requestAnimFrame(function(){main(ctx,playeur)});
		}
	</script>
</body>
</html>
